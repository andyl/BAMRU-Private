<%= javascript_include_tag "members/all_mem_indx"                       %>
<%= javascript_tag "var PREVIEW_OPTS = #{generate_preview_options};"    %>

<div id=x_container>
  <div id=x_body>
    <div id=x_header>
      <table width=100%>
        <tr>
          <td align=left><b>Unit Roster / Paging</b></td>
          <td align=right>
            <%= link_to("Edit My Contact Info", edit_member_path(current_member)) %>
          </td>
        </tr>
      </table>
    </div>
    <%= form_for @message do |f| %>
      <input type="hidden" name="message[author_id]" value="<%=current_member.id%>"/>
      <input type="hidden" name="message[ip_address]" value="<%=@client_ip%>"/>
      <div id=x_left_col>
        <table align=center><tr align=center>
          <td>
            Search: <input name="filter" id="filter-box" value="" maxlength="22" size="22" type="text">
            <input id="filter-clear-button" type="button" value="Clear"/>
          </td>
        </tr></table>
        <% cache("member_index_table-#{@fragment_type}") do %>
          <table id="myTable" class="tablesorter" style="margin-top: 0px;">
            <thead>
            <tr>
              <th>Role</th>
              <th align=center><img src="/images/page.gif" border=0></th>
              <th align=center><img src="/images/mail.gif" border=0></th>
              <th>Name</th>
            </tr>
            </thead>
            <tbody>
            <% @members.each do |m| %>
              <tr<%= roster_oot_class(m) %>>
                <td><%= m.full_roles %></td>
                <%= raw phone_checkbox(m) %>
                <%= raw email_checkbox(m) %>
                <td><a href="/members/<%= m.id %>"><%= m.full_name %><%= roster_oot_label(m) %></a></td>
              </tr>
            <% end %>
            </tbody>
          </table>
        <% end %>
      </div>
      <div id=x_right_col>
        <table width=100%>
          <tr>
            <td>
              <span style='font-size: 14px;'><b>Select Members</b></span><br/>
              <input type="checkbox" class="slx" id=cb_Bd> Board of Directors (Bd)<br/>
              <input type="checkbox" class="slx" id=cb_OL> Operations Leader (OL)<br/>
              <input type="checkbox" class="slx" id=cb_TM> <span style="margin-left:10px;">Technical Member (TM)</span><br/>
              <input type="checkbox" class="slx" id=cb_FM> <span style="margin-left:10px;">Field Member (FM)    </span><br/>
              <input type="checkbox" class="slx" id=cb_T > <span style="margin-left:10px;">Trainee (T)          </span><br/>
              <input type="checkbox" class="slx" id=cb_R > <span style="margin-left:10px;">Reserve (R)          </span><br/>
              <input type="checkbox" class="slx" id=cb_S > <span style="margin-left:10px;">Support (S)          </span><br/>
              <input type="checkbox" class="slx" id=cb_A > <span style="margin-left:10px;">Associate (A)        </span><br/>
            </td>
            <td align=right valign=top>
              <br/>
              <a href="#" id="clear_all" class="xbutton xgray">Clear All</a>
              <p></p>
              <a href="#" id="clear_sms" class="xbutton xgray">Clear SMS <img src="/images/page.gif" border=0></a>
              <p></p>
              <a href="#" id="clear_mail" class="xbutton xgray">Clear eMail <img src="/images/mail.gif" border=0></a>
              <p></p>
              <a href="#" id="clear_oot" class="xbutton xpink">Clear Unavail</a>
            </td>
          </tr>
        </table>

        <div style="padding: 4px; margin-top:10px; margin-bottom:10px; background-color:lightblue;">

          <table width=100%>
            <tr>
              <td style='font-size: 12px;'>
                <b>Send SMS / eMail</b>
              </td>
              <td align=right style='font-size: 10px;'><a href="http://wiki.bamru.net/index.php/Sending_Pages" target="_blank">help</a></td>
            </tr>
          </table>
          <table width=100%>
            <tr>
              <td><b>To:</b> <span id="addr_count">0 addresses</span></td>
              <td align=right><b>From:</b> <%= current_member.short_name %></td>
            </tr>
          </table>

          <div style="line-height: 10px; margin-bottom: 0px;">
            <textarea id="message_area" name="message[text]" rows="4" style="width: 290px; padding-bottom: 0px; margin-bottom: 0px;"></textarea>

            <table width=100% style='font-size: 8pt; margin-bottom: 0px; padding-bottom: 0px;'>
              <tr>
                <td>
                  RSVP <%= raw rsvp_select %>
                </td>
                <td align=right>
                  <span id="chars_remaining">132</span> characters left
                </td>
              </tr>
            </table>

          </div>
          <div id="rsvp_display" style='padding-top: 0px; margin-top: 0px; font-size: 10px; padding-right: 4px; padding-left: 4px; background-color: lightcyan;'></div>
          <div style="font-size: 10px; margin-bottom: 0px;">
            <table width=100% style='margin-top: 0px; padding-top: 0px;'>
              <tr style='margin-top: 0px; padding-top: 0px;'>
                <td style='font-size: 8pt;'>
                  <a href='#' id="preview_link">preview</a>
                </td>
                <td valign=top align=right>
                  <input style='width: 60px;' type="submit" value="Send"/>
                </td>
                </tr>
            </table>
          </div>
        </div>
        <div style="font-size: 10px;">
          <i>
            Last message sent <%= Message.last.created_at.strftime("%m-%d %H:%M") unless Message.last.blank? %>
            <div style='float: right; text-align: right;'><a href="/messages">Unit Message Log</a></div>
          </i>
        </div>
        <p/>

        <%= render :partial => 'smso' %>

      </div>
      </form>
    <% end %>
    <div id=x_footer style="font-size: 10pt;">
      <table width=100% style="font-size: 10pt;">
        <tr>
          <td width=33%>
            <a href="#" id=clearsort>Clear Sort Settings</a>
          </td>
          <td width=33%>
            <input type="checkbox" id=rsa_check> Show R, S, A Members
          </td>
            <td width=33%>
              <%= link_to "Edit RSVP Templates", '/rsvp_templates' %>
            </td>
        </tr>
      </table>

      <% if can? :manage, @member %>
        <table width=100% style="font-size: 10pt;">
          <tr>
            <td width=100%>
              <%= link_to "Add New Member", new_member_path %>
            </td>
          </tr>
        </table>
      <% end %>
    </div>
  </div>
</div>

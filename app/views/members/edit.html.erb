<script>var autoselectMemberNames = [ <%= @autoselect_member_names %> ];</script>

<%= javascript_tag "var AUTH_TOKEN = #{form_authenticity_token.inspect};"  %>
<%= javascript_tag "var MEMBER_ID = #{@member.id};"  %>
<%= javascript_include_tag "equal_height.js" %>
<%= javascript_include_tag "jquery-ui.min.js" %>
<%= javascript_include_tag "members_autoselect.js" %>
<%= javascript_include_tag "members_sort_photos.js" %>
<%= javascript_include_tag "members_edit_form.js" %>

<style>
  #sortable {list-style-type: none; margin: 0; padding: 0;}
  #sortable li {margin: 0 3px 3px 3px; padding: 4px; }
</style>

<div id=x_container>
  <div id=x_body>
    <div id=x_header>
      <table width=100%><tr>
        <td align=left width=33%>Member Edit</td>
        <td align=center width=33%><%= link_to("Back", member_path(@member)) %></td>
        <td align=right width=33%>
            <input size=14 id="autoselect" value="Find Member">
        </td>
      </tr></table>
    </div>
    <div id=x_left_col>
      <p/>
      <div style="text-align: center;"><a href="#" id="save_link">Save</a> | <%= link_to "Reset", edit_member_path(@member)%></div>
      <p/>
      <%= form_for(@member, :html => {:id => 'memberz_form'}) do |f| %>
        <%= render "shared/error_messages", :target => @member %>
        <%= f.text_field :full_name, :size => 28 %><br/>
        <%= f.select :typ, %w(TM FM T R S A) %>
        Bd: <%= f.check_box('bd') %>
        OL: <%= f.check_box('ol') %>
        <p></p><b>Phones</b> <span class=add><%= link_to_add_fields("add", f, :phones)%></span>
        <div id=sortable_phones>
          <% @member.phones.sort {|x,y| x.position <=> y.position}.each do |xphone| %>
            <%= f.fields_for :phones, xphone do |phone| %>
              <%= render "phone_fields", :f => phone %>
            <% end %>
          <% end %>
        </div>
        <p/><b>eMails</b> <span class=add><%= link_to_add_fields("add", f, :emails) %></span><br/>
        <%= f.fields_for :emails do |email| %>
          <%= render "email_fields", :f => email %>
        <% end %>
        <p/><b>Addresses</b> <span class=add><%= link_to_add_fields("add", f, :addresses)%></span><br/>
        <%= f.fields_for :addresses do |address| %>
          <%= render "address_fields", :f => address %>
        <% end %>
        <p/><b>Emergency Phone Contacts</b> <span class=add><%= link_to_add_fields("add", f, :emergency_contacts)%></span><br/>
        <%= f.fields_for :emergency_contacts do |contact| %>
          <%= render "emergency_contact_fields", :f => contact %>
        <% end %>
        <p/><b>Other Info</b> <span class=add><%= link_to_add_fields("add", f, :other_infos)%></span><br/>
        <%= f.fields_for :other_infos do |record| %>
          <%= render "other_info_fields", :f => record %>
        <% end %>
        <p/><b>Password</b><br/>
        <span class=plabel>Password: </span>
        <%= f.password_field :password, :size => 13 %><br/>
        <span class=plabel>Confirmation: </span>
        <%= f.password_field :password_confirmation, :size => 13 %>
        <p/><b>Ham & V9</b><br/>
        <span class=hlabel>Ham: </span>
        <%= f.text_field :ham, :size => 5 %><br/>
        <span class=hlabel> V9: </span>
        <%= f.text_field :v9, :size => 5 %><p/>
        <p/>
      <% end %>
    </div>
    <div id=x_right_col style="text-align: center;">
      <p/><%= link_to "Add New Photo", new_member_photo_path(@member) %><p/>
      <div id=sortable_photos>
        <% @member.photos.each do |pic| %>
          <li style="list-style-type: none;" id=photos_<%= pic.id %>>
            <span class=sort_handle>(+)</span>
            <%= image_tag pic.image.url(:thumb) %>
            <%= link_to 'remove', member_photo_path(@member, pic), :confirm => 'Are you sure?',:method => :delete %>
          </li>
        <% end %>
      </div>
    </div>

    <div id=x_footer>

    </div>
  </div>
</div>
